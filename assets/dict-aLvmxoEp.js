var e=Object.defineProperty,t=Object.defineProperties,i=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,d=Object.prototype.propertyIsEnumerable,c=(t,i,s)=>i in t?e(t,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[i]=s,a=(e,t)=>{for(var i in t||(t={}))r.call(t,i)&&c(e,i,t[i]);if(s)for(var i of s(t))d.call(t,i)&&c(e,i,t[i]);return e},n=(e,s)=>t(e,i(s)),o=(e,t,i)=>new Promise((s,r)=>{var d=e=>{try{a(i.next(e))}catch(t){r(t)}},c=e=>{try{a(i.throw(e))}catch(t){r(t)}},a=e=>e.done?s(e.value):Promise.resolve(e.value).then(d,c);a((i=i.apply(e,t)).next())});import{dT as l,dS as u}from"./index-tq4TX8ps.js";function _(e){return o(this,null,function*(){const{dictName:t,dictTypeId:i,status:s,page:r=1,pageSize:d=10}=e||{};let c=u.from("sys_dict_type").select("*",{count:"exact"}),o=(r-1)*d;t&&(c=c.ilike("dict_name",`%${t}%`),o=0),i&&(c=c.ilike("dict_type_id",`%${i}%`),o=0),void 0!==s&&(c=c.eq("status",1===s),o=0);const{data:_,error:y,count:p}=yield c.order("create_time",{ascending:!1}).range(o,o+d-1);if(y&&l(y.code,"获取字典类型列表失败"),_){return{list:_.map(e=>n(a({},e),{status:e.status?1:0})),total:p||0,page:r,pageSize:d}}return{list:[],total:0,page:r,pageSize:d}})}function y(e){return o(this,null,function*(){const{dictName:t,dictTypeId:i,status:s,remark:r}=e,{data:d,error:c}=yield u.from("sys_dict_type").select("id").eq("dict_type_id",i).single();("PGRST116"!==(null==c?void 0:c.code)||d)&&l(c.code,"字典类型已存在");const{data:a,error:n}=yield u.from("sys_dict_type").insert({dict_name:t,dict_type_id:i,status:s,remark:r}).select("id").single();return!n&&a||l(n.code,"创建字典类型失败"),{message:"创建字典类型成功"}})}function p(e,t){return o(this,null,function*(){e||l("0","字典类型ID不能为空");const{dictName:i,status:s,remark:r}=t,{data:d,error:c}=yield u.from("sys_dict_type").select("id").eq("id",e).single();!c&&d||l(c.code,"字典类型不存在");const{error:a}=yield u.from("sys_dict_type").update({dict_name:i,status:s,remark:r}).eq("id",e);return a&&l(a.code,"更新字典类型失败"),{message:"更新字典类型成功"}})}function f(e){return o(this,null,function*(){e||l("0","字典类型ID不能为空");const{data:t,error:i}=yield u.from("sys_dict_type").select("id").eq("id",e).single();!i&&t||l(i.code,"字典类型不存在");const{data:s,error:r}=yield u.from("sys_dict_item").select("id");r&&l(r.code,"检查字典数据失败"),s&&s.length>0&&l("0","该字典类型下存在字典数据，无法删除");const{error:d}=yield u.from("sys_dict_type").delete().eq("id",e);return d&&l(d.code,"删除字典类型失败"),{message:"删除字典类型成功"}})}function m(e){return o(this,null,function*(){const{dictTypeId:t,dictLabel:i,status:s,page:r=1,pageSize:d=10}=e||{};let c=(r-1)*d,o=u.from("sys_dict_item").select("*",{count:"exact"});t&&(o=o.eq("dict_type_id",t),c=0),i&&(o=o.ilike("dict_label",`%${i}%`),c=0),void 0!==s&&(o=o.eq("status",1===s),c=0);const{data:_,error:y,count:p}=yield o.order("sort",{ascending:!0}).range(c,c+d-1);if(y&&l(y.code,"获取字典数据列表失败"),_){return{list:_.map(e=>n(a({},e),{status:e.status?1:0,is_default:e.is_default?1:0})),total:p||0,page:r,pageSize:d}}return{list:[],total:0,page:r,pageSize:d}})}function g(e){return o(this,null,function*(){const{dict_type_id:t,dict_label:i,dict_value:s,sort:r,status:d,description:c,is_default:a}=e,{data:n}=yield u.from("sys_dict_item").select("id").eq("dict_type_id",t).eq("dict_value",s).single();n&&l("0","字典数据已存在");const{data:o,error:_}=yield u.from("sys_dict_item").insert({dict_type_id:t,dict_label:i,dict_value:s,sort:r,status:d,description:c,is_default:a}).select("id").single();return!_&&o||l(_.code,"创建字典数据失败"),{message:"创建字典数据成功"}})}function v(e,t){return o(this,null,function*(){e||l("0","字典数据ID不能为空");const{dict_type_id:i,dict_label:s,dict_value:r,sort:d,status:c,description:a,is_default:n}=t,{data:o}=yield u.from("sys_dict_item").select("id, dict_type_id, dict_value").eq("id",e).single();if(o&&l("0","字典数据已存在"),i!==o.dict_type_id||r!==o.dict_value){const{data:t,error:s}=yield u.from("sys_dict_item").select("id").eq("dict_type_id",i).eq("dict_value",r).neq("id",e).single();("PGRST116"!==(null==s?void 0:s.code)||t)&&l(s.code,"字典数据已存在")}const{error:_}=yield u.from("sys_dict_item").update({dict_type_id:i,dict_label:s,dict_value:r,sort:d,status:1===c,description:a,is_default:"Y"===n}).eq("id",e);return _&&l(_.code,"更新字典数据失败"),{message:"更新字典数据成功"}})}function b(e){return o(this,null,function*(){e||l("0","字典数据ID不能为空");const{data:t,error:i}=yield u.from("sys_dict_item").select("id").eq("id",e).single();!i&&t||l(i.code,"字典数据不存在");const{error:s}=yield u.from("sys_dict_item").delete().eq("id",e);return s&&l(s.code,"删除字典数据失败"),{message:"删除字典数据成功"}})}function q(){return o(this,null,function*(){const{data:e,error:t}=yield u.from("sys_dict_type").select("*").eq("status",!0).order("sort",{ascending:!0});return t&&l(t.code,"获取字典选择框数据失败"),e})}export{y as a,p as b,g as c,f as d,b as e,_ as f,q as g,m as h,v as u};
