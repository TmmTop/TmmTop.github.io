var e=(e,a,l)=>new Promise((t,i)=>{var o=e=>{try{s(l.next(e))}catch(a){i(a)}},d=e=>{try{s(l.throw(e))}catch(a){i(a)}},s=e=>e.done?t(e.value):Promise.resolve(e.value).then(o,d);s((l=l.apply(e,a)).next())});import{d as a,c as l,a as t,r as i,w as o,y as d,f as s,z as r,p as u,h as m,l as n,N as c,n as p}from"./index-tq4TX8ps.js";import{E as f}from"./el-dialog-BuI0cT_W.js";import"./el-overlay-eO4DGCYD.js";import{E as _}from"./el-button-DyAC8C5p.js";import{E as g,a as v}from"./el-form-item-DcUonGVO.js";import{a as b,b as y}from"./el-radio-DLchf3N0.js";/* empty css                       */import{E as h}from"./el-row-B5j5eqHP.js";import{E as w}from"./el-col-BO93OLd3.js";/* empty css                 */import{a as V,b as x}from"./dict-aLvmxoEp.js";import{E as j}from"./index-DiYLWqjA.js";const D={class:"dialog-footer"},E=a({__name:"DictTypeDialog",props:{visible:{type:Boolean},type:{},dictData:{}},emits:["update:visible","submit"],setup(a,{emit:E}){const k=a,U=E,q=l({get:()=>k.visible,set:e=>U("update:visible",e)}),z=l(()=>k.type),C=t(),H=t(!1),I=i({dict_code:"",dict_name:"",description:"",sort:0,status:1}),M={dict_code:[{required:!0,message:"请输入字典类型编码",trigger:"blur"},{min:2,max:50,message:"长度在 2 到 50 个字符",trigger:"blur"},{pattern:/^[a-zA-Z0-9_]+$/,message:"只能包含字母、数字和下划线",trigger:"blur"}],dict_name:[{required:!0,message:"请输入字典类型名称",trigger:"blur"},{min:2,max:50,message:"长度在 2 到 50 个字符",trigger:"blur"}],description:[{max:500,message:"长度不能超过 500 个字符",trigger:"blur"}]};o(()=>[k.visible,k.type,k.dictData],([a])=>{a&&(e(null,null,function*(){const e="edit"===k.type&&k.dictData,a=k.dictData;Object.assign(I,{dict_code:e&&a&&a.dict_code||"",dict_name:e&&a&&a.dict_name||"",description:e&&a&&a.description||"",sort:e&&a?a.sort:0,status:e&&a?a.status:1})}),p(()=>{var e;null==(e=C.value)||e.clearValidate()}))},{immediate:!0});const P=()=>e(null,null,function*(){C.value&&(yield C.value.validate(a=>e(null,null,function*(){var e;if(a){H.value=!0;try{if("add"===z.value)yield V(I),c.success("添加成功");else{if(!(null==(e=k.dictData)?void 0:e.id))throw new Error("字典类型ID不存在");yield x(k.dictData.id,I),c.success("更新成功")}q.value=!1,U("submit")}catch(l){c.error(l.message||"操作失败")}finally{H.value=!1}}})))});return(e,a)=>{const l=j,t=v,i=w,o=h,c=y,p=b,V=g,x=_,E=f;return s(),d(E,{modelValue:q.value,"onUpdate:modelValue":a[5]||(a[5]=e=>q.value=e),title:"add"===z.value?"添加字典类型":"编辑字典类型",width:"600px","align-center":"","close-on-click-modal":!1},{footer:r(()=>[m("div",D,[u(x,{onClick:a[4]||(a[4]=e=>q.value=!1)},{default:r(()=>[...a[6]||(a[6]=[n("取消",-1)])]),_:1}),u(x,{type:"primary",onClick:P,loading:H.value},{default:r(()=>[...a[7]||(a[7]=[n("提交",-1)])]),_:1},8,["loading"])])]),default:r(()=>[u(V,{ref_key:"formRef",ref:C,model:I,rules:M,"label-width":"120px"},{default:r(()=>[u(o,{gutter:20},{default:r(()=>[u(i,{span:24},{default:r(()=>[u(t,{label:"类型编码",prop:"dict_code"},{default:r(()=>[u(l,{modelValue:I.dict_code,"onUpdate:modelValue":a[0]||(a[0]=e=>I.dict_code=e),placeholder:"请输入类型编码",disabled:"edit"===z.value,clearable:"",maxlength:50,"show-word-limit":""},null,8,["modelValue","disabled"])]),_:1})]),_:1}),u(i,{span:24},{default:r(()=>[u(t,{label:"类型名称",prop:"dict_name"},{default:r(()=>[u(l,{modelValue:I.dict_name,"onUpdate:modelValue":a[1]||(a[1]=e=>I.dict_name=e),placeholder:"请输入类型名称",clearable:"",maxlength:50,"show-word-limit":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),u(o,{gutter:20},{default:r(()=>[u(i,{span:12},{default:r(()=>[u(t,{label:"状态",prop:"status"},{default:r(()=>[u(p,{modelValue:I.status,"onUpdate:modelValue":a[2]||(a[2]=e=>I.status=e),placeholder:"请选择状态",style:{width:"100%"}},{default:r(()=>[u(c,{label:"启用",value:1}),u(c,{label:"禁用",value:0})]),_:1},8,["modelValue"])]),_:1})]),_:1}),u(i,{span:24},{default:r(()=>[u(t,{label:"类型描述",prop:"description"},{default:r(()=>[u(l,{modelValue:I.description,"onUpdate:modelValue":a[3]||(a[3]=e=>I.description=e),type:"textarea",rows:3,placeholder:"请输入类型描述",clearable:"",maxlength:500,"show-word-limit":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}});export{E as _};
