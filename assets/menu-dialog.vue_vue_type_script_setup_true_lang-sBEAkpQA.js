var e=Object.defineProperty,t=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,s=(t,a,l)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[a]=l,i=(e,t,a)=>new Promise((l,s)=>{var i=e=>{try{p(a.next(e))}catch(t){s(t)}},r=e=>{try{p(a.throw(e))}catch(t){s(t)}},p=e=>e.done?l(e.value):Promise.resolve(e.value).then(i,r);p((a=a.apply(e,t)).next())});import{d as r,a as p,r as o,c as n,aI as d,w as u,y as c,f as y,z as m,p as b,u as h,I as g,h as f,l as v,a8 as k,aa as w,dN as x,dZ as T,N as I,d_ as P,n as _,dU as B,dM as H}from"./index-Q3P-rwBo.js";import{E}from"./el-dialog-DSZOKVfF.js";import"./el-overlay-BNvnZVrW.js";import{E as j}from"./el-button-CEOXYcAP.js";/* empty css                */import{_ as A}from"./index.vue_vue_type_script_setup_true_lang-CDyBcjrc.js";import{E as F}from"./index-BPdM6V2I.js";const O={class:"dialog-footer"},q=r({__name:"menu-dialog",props:{visible:{type:Boolean,default:!1},editData:{},lockType:{type:Boolean,default:!1}},emits:["update:visible","submit"],setup(e,{emit:r}){const{width:q}=d(),D=(e,t)=>()=>k("span",{class:"flex items-center"},[k("span",e),k(F,{content:t,placement:"top"},()=>k(w,{class:"ml-0.5 cursor-help"},()=>k(x)))]),V=e,C=r,N=p(),S=p(!1),U=o({id:0,parentId:0,type:0,name:"",path:"",title:"",component:"",perms:"",icon:"",isEnable:!0,sort:1,keepAlive:!1,isHide:!1,isHideTab:!1,link:"",isIframe:!1,showBadge:!1,showTextBadge:"",fixedTab:!1,activePath:"",roles:[],isFullPage:!1}),z=p([]),G=e=>e.map(e=>({id:e.id,title:H(e.title)||H(e.title)||"未命名菜单",component:e.component,children:e.children?G(e.children):[]})),M=o({type:[{required:!0,message:"请选择菜单类型",trigger:"change"}],parentId:[{required:!0,message:"请选择父级目录",trigger:"change"}],name:[{required:!0,message:"请输入菜单名称",trigger:"blur"},{min:2,max:50,message:"长度在 2 到 50 个字符",trigger:"blur"}],path:[{required:!0,message:"请输入路由地址",trigger:"blur"}],label:[{required:!0,message:"请输入权限标识",trigger:"blur"}]}),R=n(()=>{const e=q.value<640?12:6,t=[{label:"父级目录",key:"parentId",type:"treeselect",props:{data:z.value,props:{label:"title",value:"id",children:"children"},placeholder:"选择父级目录",clearable:!0,defaultExpandAll:!0,checkStrictly:!0}},{label:"菜单类型",key:"type",type:"select",props:{options:[{label:"目录",value:0},{label:"菜单",value:1},{label:"按钮",value:2}]}}],a=[{label:"按钮名称",key:"title",type:"input",props:{placeholder:"按钮名称"}},{label:"按钮标识",key:"name",type:"input",props:{placeholder:"按钮标识"}},{label:"权限标识",key:"perms",type:"input",props:{placeholder:"如：user:add"}},{label:"权限排序",key:"sort",type:"number",props:{min:1,controlsPosition:"right",style:{width:"100%"}}},{label:"是否启用",key:"isEnable",type:"switch",span:e}],l=[{label:"菜单标识",key:"name",type:"input",props:{placeholder:"菜单标识"}},{label:"菜单名称",key:"title",type:"input",props:{placeholder:"菜单名称"}},{label:"菜单排序",key:"sort",type:"number",props:{min:1,controlsPosition:"right",style:{width:"100%"}}},{label:D("路由地址","二级及以下：相对路径（如 console、user）"),key:"path",type:"input",props:{placeholder:"如：console 或 user"}},{label:"权限标识",key:"perms",type:"input",props:{placeholder:"如：user:add"}},{label:D("组件路径","具体页面：填写组件路径（如 /system/user）\n目录菜单：留空"),key:"component",type:"input",props:{placeholder:"如：/system/user 或留空"}},{label:"图标",key:"icon",type:"input",props:{placeholder:"如：ri:user-line"}},{label:"外部链接",key:"link",type:"input",props:{placeholder:"如：https://www.example.com"}},{label:D("激活路径",'用于详情页等隐藏菜单，指定高亮显示的父级菜单路径\n例如：用户详情页高亮显示"用户管理"菜单'),key:"activePath",type:"input",props:{placeholder:"如：/system/user"}},{label:"是否启用",key:"isEnable",type:"switch",span:e},{label:"页面缓存",key:"keepAlive",type:"switch",span:e},{label:"隐藏菜单",key:"isHide",type:"switch",span:e},{label:"是否内嵌",key:"isIframe",type:"switch",span:e},{label:"显示徽章",key:"showBadge",type:"switch",span:e},{label:"固定标签",key:"fixedTab",type:"switch",span:e},{label:"标签隐藏",key:"isHideTab",type:"switch",span:e},{label:"全屏页面",key:"isFullPage",type:"switch",span:e},{label:"文本徽章",key:"showTextBadge",type:"input",props:{placeholder:"如：New、Hot"}}];let s=[];return s=2===U.type?a:l,[...t,...s]}),Z=n(()=>{if(S.value){if(0===U.type)return"编辑目录";if(1===U.type)return"编辑菜单";if(2===U.type)return"编辑按钮"}else{if(0===U.type)return"新建目录";if(1===U.type)return"新建菜单";if(2===U.type)return"新建按钮"}}),J=()=>i(null,null,function*(){if(N.value)try{yield N.value.validate();const e={type:void 0!==U.type?U.type:0,parentId:U.parentId||0,path:U.path,name:U.name,component:U.component,title:U.title,perms:U.perms,icon:U.icon,showBadge:U.showBadge,showTextBadge:U.showTextBadge,isHide:U.isHide,isHideTab:U.isHideTab,link:U.link,isIframe:U.isIframe,keepAlive:U.keepAlive,fixedTab:U.fixedTab,isFullPage:U.isFullPage,sort:U.sort||1,status:U.isEnable};S.value&&U.id?(yield T(U.id.toString(),e),I.success("编辑成功")):(yield P(e),I.success("新增成功")),C("submit",((e,i)=>{for(var r in i||(i={}))a.call(i,r)&&s(e,r,i[r]);if(t)for(var r of t(i))l.call(i,r)&&s(e,r,i[r]);return e})({},U)),K()}catch(e){I.error("表单校验失败，请检查输入")}}),K=()=>{C("update:visible",!1)},L=()=>{var e;null==(e=N.value)||e.reset(),U.parentId=0,U.type=0,U.isEnable=!0,S.value=!1};return u(()=>V.visible,e=>{e&&(i(null,null,function*(){try{const e=yield B(),t=G(e);z.value=[{id:0,title:"顶级菜单",children:[]},...t]}catch(e){}}),_(()=>{V.editData&&(()=>{if(U.isEnable=!0,!V.editData)return;S.value=!0;const e=V.editData;U.isEnable=1===e.status||1===e.status,U.id=e.id||0,U.parentId=e.parent_id||0,U.type=void 0!==e.type?e.type:0,U.name=e.name||e.name||"",U.path=e.path||"",U.title=e.title||e.title||"",U.perms=e.perms||e.perms||"",U.component=e.component||"",U.icon=e.icon||e.icon||"",U.sort=e.sort||e.sort||1,U.keepAlive=e.keepAlive,U.isHide=e.isHide,U.isHideTab=e.isHideTab,U.isEnable=1===e.status||1===e.status,U.link=e.link||"",U.isIframe=e.isIframe,U.showBadge=e.showBadge,U.showTextBadge=e.showTextBadge||"",U.fixedTab=e.fixedTab,U.activePath=e.activePath||"",U.roles=e.roles||[],U.isFullPage=e.isFullPage})()}))}),(t,a)=>{const l=j,s=E;return y(),c(s,{title:h(Z),"model-value":e.visible,"onUpdate:modelValue":K,width:"860px","align-center":"",class:"menu-dialog",onClosed:L},{footer:m(()=>[f("span",O,[b(l,{onClick:K},{default:m(()=>[...a[1]||(a[1]=[v("取 消",-1)])]),_:1}),b(l,{type:"primary",onClick:J},{default:m(()=>[...a[2]||(a[2]=[v("确 定",-1)])]),_:1})])]),default:m(()=>[b(A,{ref_key:"formRef",ref:N,modelValue:h(U),"onUpdate:modelValue":a[0]||(a[0]=e=>g(U)?U.value=e:null),items:h(R),rules:h(M),span:h(q)>640?12:24,gutter:20,"label-width":"100px","show-reset":!1,"show-submit":!1},null,8,["modelValue","items","rules","span"])]),_:1},8,["title","model-value"])}}});export{q as _};
