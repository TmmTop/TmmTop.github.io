var e=Object.defineProperty,t=Object.defineProperties,o=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,i=(t,o,r)=>o in t?e(t,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[o]=r,n=(e,t)=>{for(var o in t||(t={}))s.call(t,o)&&i(e,o,t[o]);if(r)for(var o of r(t))a.call(t,o)&&i(e,o,t[o]);return e},p=(e,r)=>t(e,o(r)),l=(e,t,o)=>new Promise((r,s)=>{var a=e=>{try{n(o.next(e))}catch(t){s(t)}},i=e=>{try{n(o.throw(e))}catch(t){s(t)}},n=e=>e.done?r(e.value):Promise.resolve(e.value).then(a,i);n((o=o.apply(e,t)).next())});import{d as m,v as u,a as d,F as c,e as j,f as g,p as h,u as f,I as y,z as v,J as _,k as b,y as x,l as w,m as S,n as C,N as O,a8 as P}from"./index-tq4TX8ps.js";import{E as T}from"./el-card-1TQtZHl7.js";import{_ as k}from"./index-D7po0RYc.js";import{_ as E}from"./index-CJmSPapq.js";import{E as $}from"./el-space-DCpBHUry.js";import{E as z}from"./el-button-DyAC8C5p.js";import{u as D}from"./useTable-BCdofZYT.js";import{d as N,g as F}from"./post-BKd4v_6B.js";import{_ as I}from"./post-search.vue_vue_type_script_setup_true_lang-CtR1NDxc.js";import{_ as R}from"./post-dialog.vue_vue_type_script_setup_true_lang-B74VxZSS.js";import{_ as A}from"./index.vue_vue_type_script_setup_true_lang-AGHcUgcb.js";/* empty css                *//* empty css                *//* empty css              */import{u as B}from"./useAuth-DYABuLzu.js";import{E as M}from"./index-Cpz5_xtZ.js";import{E as V}from"./index-BXZ9ghwX.js";import{E as q}from"./index-Ci_xIpBh.js";import"./el-pagination-Iu5NmV1u.js";import"./el-option-DXreI6jV.js";import"./index-CANQjRc0.js";import"./index-WcMWsiUt.js";import"./token-DWNpOE8r.js";import"./strings-DOQVhMSl.js";import"./castArray-CHqCdZGF.js";import"./index-DlvAES6j.js";import"./index-DK0M4ZfF.js";import"./use-form-common-props-C1bnLtuv.js";import"./index-DiYLWqjA.js";import"./event-BwRzfsZt.js";import"./index-CZ4uNybv.js";import"./aria-Dle50h-X.js";import"./scroll-CqDkJM1i.js";import"./debounce-638yRgBG.js";import"./toNumber-BfVc6Erv.js";import"./_baseIteratee-BuWUDJq-.js";import"./index-xLBHopRw.js";import"./vnode-C19zY2fz.js";/* empty css               *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                 */import"./el-table-column-BdqWJFUj.js";import"./_initCloneObject-SAMSSefA.js";import"./isArrayLikeObject-37-MgwE7.js";import"./raf-B9nJDbop.js";import"./index-CxO9A_c5.js";/* empty css                    *//* empty css                   */import"./el-empty-Bfaz4LgP.js";import"./formEnum-BLgiZVxV.js";import"./_plugin-vue_export-helper-BCo6x5W8.js";import"./el-popover-VYFidXkA.js";import"./el-dropdown-item-C5MgInp0.js";import"./refs-Cw5r5QN8.js";import"./index-DlJfAqfE.js";/* empty css                        */import"./index.vue_vue_type_script_setup_true_lang-OUKHz1NZ.js";import"./vue-draggable-plus-Dh_etvWk.js";import"./useTableColumns-4pdzumz-.js";import"./index-BQes9nue.js";import"./el-form-item-DcUonGVO.js";import"./_baseClone-Cjzv5Fw5.js";import"./el-row-B5j5eqHP.js";import"./el-col-BO93OLd3.js";import"./el-radio-DLchf3N0.js";import"./tree-select-Bvj0mN0n.js";import"./cloneDeep-67QEKC_q.js";import"./index-Ccr30ub6.js";import"./index-CCK94ktD.js";import"./clamp-8JRzLQ7F.js";import"./index-gtba-Hok.js";import"./index-DdKsqEII.js";import"./index-T9D55G5l.js";import"./index-DL46FidT.js";import"./index-CK6JhDoQ.js";import"./validator--HL6f0Bm.js";import"./el-dialog-BuI0cT_W.js";import"./index-ChLCAD_I.js";import"./el-overlay-eO4DGCYD.js";import"./index-DB3QIKIw.js";/* empty css                        */const H={class:"post-page art-full-height"},J=m(p(n({},{name:"Post"}),{__name:"index",setup(e){const{t:t}=u(),{hasAuth:o}=B(),r=d("add"),s=d(!1),a=d({}),i=d([]),m=d({postName:void 0,status:void 0}),J={0:{type:"info",text:"禁用"},1:{type:"success",text:"启用"}},{columns:U,columnChecks:K,data:L,loading:W,pagination:X,fetchData:Y,searchParams:G,resetSearchParams:Q,handleSizeChange:Z,handleCurrentChange:ee,refreshData:te}=D({core:{apiFn:F,apiParams:n({pageNum:1,pageSize:10},m.value),paginationKey:{current:"pageNum",size:"pageSize"},columnsFactory:()=>[{type:"selection"},{type:"index",width:60,label:"序号"},{prop:"post_name",label:"岗位名称",width:150,showOverflowTooltip:!0},{prop:"post_code",label:"岗位编码",width:150,showOverflowTooltip:!0},{prop:"description",label:"岗位描述",minWidth:200,showOverflowTooltip:!0},{prop:"status",label:"状态",width:80,formatter:e=>{const t=(o=e.status,J[o]||{type:"info",text:"未知"});var o;return P(V,{type:t.type},()=>t.text)}},{prop:"sort",label:"排序",width:80},{prop:"create_time",label:"创建时间",width:180,sortable:!0,showOverflowTooltip:!0,formatter:e=>(e=>{if(!e)return"-";const t=new Date(e);return isNaN(t.getTime())?"-":`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")} ${String(t.getHours()).padStart(2,"0")}:${String(t.getMinutes()).padStart(2,"0")}:${String(t.getSeconds()).padStart(2,"0")}`})(e.create_time)},{prop:"operation",label:"操作",width:180,fixed:"right",formatter:e=>P("div",[P(q,{content:t("menus.system.edit"),placement:"top"},()=>P(A,{type:"edit",onClick:()=>re("edit",e),style:o("post:update")?"":"display: none"})),P(q,{content:t("menus.system.delete"),placement:"top"},()=>P(A,{type:"delete",onClick:()=>ae(e),style:o("post:delete")?"":"display: none"}))])}]}}),oe=e=>{Object.assign(G,p(n({},e),{pageNum:1})),Y()},re=(e,t)=>{r.value=e,a.value=t||{},C(()=>{s.value=!0})},se=()=>{if(0===i.value.length)return void O.warning("请选择要删除的岗位");const e=i.value.map(e=>e.post_name).join("、");M.confirm(`确定要删除选中的 ${i.value.length} 个岗位吗？\n${e}`,"批量删除岗位",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>l(null,null,function*(){try{const e=i.value.map(e=>e.id);let t=0;for(const o of e){(yield N(o.toString()))&&t++}t>0&&(O.success("批量删除成功"),i.value=[],te())}catch(e){O.error("批量删除失败")}})).catch(()=>{})},ae=e=>{M.confirm(`确定要删除岗位"${e.post_name}"吗？`,"删除岗位",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>l(null,null,function*(){try{(yield N(e.id.toString()))&&(O.success("删除成功"),te())}catch(t){O.error("删除失败")}})).catch(()=>{})},ie=()=>l(null,null,function*(){try{s.value=!1,a.value={},te()}catch(e){}}),ne=e=>{i.value=e};return(e,t)=>{const n=z,p=$,l=E,u=k,d=T,C=c("ripple");return g(),j("div",H,[h(I,{modelValue:f(m),"onUpdate:modelValue":t[0]||(t[0]=e=>y(m)?m.value=e:null),onSearch:oe,onReset:f(Q),"search-auth":"post:query","reset-auth":"post:query"},null,8,["modelValue","onReset"]),h(d,{class:"art-table-card",shadow:"never"},{default:v(()=>[h(l,{columns:f(K),"onUpdate:columns":t[2]||(t[2]=e=>y(K)?K.value=e:null),loading:f(W),onRefresh:f(te),"search-auth":"post:query","refresh-auth":"post:query"},{left:v(()=>[h(p,{wrap:""},{default:v(()=>[f(o)("post:add")?_((g(),x(n,{key:0,onClick:t[1]||(t[1]=e=>re("add"))},{default:v(()=>[...t[4]||(t[4]=[w("新增岗位",-1)])]),_:1})),[[C]]):b("",!0),f(o)("post:batchDelete")?_((g(),x(n,{key:1,onClick:se,disabled:0===f(i).length,type:"danger"},{default:v(()=>[w(" 批量删除("+S(f(i).length)+") ",1)]),_:1},8,["disabled"])),[[C]]):b("",!0)]),_:1})]),_:1},8,["columns","loading","onRefresh"]),h(u,{loading:f(W),data:f(L),columns:f(U),pagination:f(X),onSelectionChange:ne,"onPagination:sizeChange":f(Z),"onPagination:currentChange":f(ee)},null,8,["loading","data","columns","pagination","onPagination:sizeChange","onPagination:currentChange"]),h(R,{visible:f(s),"onUpdate:visible":t[3]||(t[3]=e=>y(s)?s.value=e:null),type:f(r),"post-data":f(a),onSubmit:ie},null,8,["visible","type","post-data"])]),_:1})])}}}));export{J as default};
