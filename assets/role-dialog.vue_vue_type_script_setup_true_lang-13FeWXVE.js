var e=(e,l,a)=>new Promise((o,t)=>{var r=e=>{try{d(a.next(e))}catch(l){t(l)}},s=e=>{try{d(a.throw(e))}catch(l){t(l)}},d=e=>e.done?o(e.value):Promise.resolve(e.value).then(r,s);d((a=a.apply(e,l)).next())});import{d as l,c as a,a as o,r as t,w as r,y as s,f as d,z as i,p as u,u as m,h as n,l as p,I as c,N as f,n as g}from"./index-tq4TX8ps.js";import{E as v}from"./el-dialog-BuI0cT_W.js";import"./el-overlay-eO4DGCYD.js";import{E as b}from"./el-button-DyAC8C5p.js";import{E as y,a as _}from"./el-form-item-DcUonGVO.js";/* empty css               */import{E as V,a as j}from"./el-option-DXreI6jV.js";/* empty css                  *//* empty css                     *//* empty css                  *//* empty css                 *//* empty css                        */import{E as h}from"./el-row-B5j5eqHP.js";import{E as x}from"./el-col-BO93OLd3.js";import{c as N,u as C}from"./role-CTBCBT8L.js";import{E as w}from"./index-DiYLWqjA.js";import{E}from"./index-gtba-Hok.js";const k={class:"dialog-footer"},U=l({__name:"role-dialog",props:{visible:{type:Boolean},type:{},roleData:{}},emits:["update:visible","submit"],setup(l,{emit:U}){const D=l,I=U,P=a({get:()=>D.visible,set:e=>I("update:visible",e)}),q=a(()=>D.type),H=o(),K=o(!1),M=t({roleCode:"",roleName:"",description:"",sort:0,status:1}),O={roleCode:[{required:!0,message:"请输入角色编码",trigger:"blur"},{min:2,max:50,message:"长度在 2 到 50 个字符",trigger:"blur"}],roleName:[{required:!0,message:"请输入角色名称",trigger:"blur"},{min:2,max:50,message:"长度在 2 到 50 个字符",trigger:"blur"}],description:[{max:500,message:"长度不能超过 500 个字符",trigger:"blur"}]};r(()=>[D.visible,D.type,D.roleData],([l])=>{l&&(e(null,null,function*(){const e="edit"===D.type&&D.roleData,l=D.roleData;Object.assign(M,{roleCode:e&&l&&l.role_code||"",roleName:e&&l&&l.role_name||"",description:e&&l&&l.description||"",sort:e&&l?l.sort:0,status:e&&l?l.status:1})}),g(()=>{var e;null==(e=H.value)||e.clearValidate()}))},{immediate:!0});const R=()=>e(null,null,function*(){H.value&&(yield H.value.validate(l=>e(null,null,function*(){var e;if(l){K.value=!0;try{"add"===q.value?(yield N({roleName:M.roleName,roleKey:M.roleCode,roleSort:M.sort,status:1===M.status,remark:M.description,menuIds:[]}),f.success("添加成功")):(yield C(null==(e=D.roleData)?void 0:e.id,{roleName:M.roleName,roleKey:M.roleCode,roleSort:M.sort,status:1===M.status,remark:M.description,menuIds:[]}),f.success("更新成功")),P.value=!1,I("submit")}catch(a){f.error(a.message||"操作失败")}finally{K.value=!1}}})))});return(e,l)=>{const a=w,o=_,t=x,r=h,f=E,g=j,N=V,C=y,U=b,D=v;return d(),s(D,{modelValue:m(P),"onUpdate:modelValue":l[6]||(l[6]=e=>c(P)?P.value=e:null),title:"add"===m(q)?"添加角色":"编辑角色",width:"600px","align-center":"","close-on-click-modal":!1},{footer:i(()=>[n("div",k,[u(U,{onClick:l[5]||(l[5]=e=>P.value=!1)},{default:i(()=>[...l[7]||(l[7]=[p("取消",-1)])]),_:1}),u(U,{type:"primary",onClick:R,loading:m(K)},{default:i(()=>[...l[8]||(l[8]=[p("提交",-1)])]),_:1},8,["loading"])])]),default:i(()=>[u(C,{ref_key:"formRef",ref:H,model:m(M),rules:O,"label-width":"100px"},{default:i(()=>[u(r,{gutter:20},{default:i(()=>[u(t,{span:12},{default:i(()=>[u(o,{label:"角色编码",prop:"roleCode"},{default:i(()=>[u(a,{modelValue:m(M).roleCode,"onUpdate:modelValue":l[0]||(l[0]=e=>m(M).roleCode=e),placeholder:"请输入角色编码",disabled:"edit"===m(q)},null,8,["modelValue","disabled"])]),_:1})]),_:1}),u(t,{span:12},{default:i(()=>[u(o,{label:"角色名称",prop:"roleName"},{default:i(()=>[u(a,{modelValue:m(M).roleName,"onUpdate:modelValue":l[1]||(l[1]=e=>m(M).roleName=e),placeholder:"请输入角色名称"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),u(o,{label:"角色描述",prop:"description"},{default:i(()=>[u(a,{modelValue:m(M).description,"onUpdate:modelValue":l[2]||(l[2]=e=>m(M).description=e),type:"textarea",rows:3,placeholder:"请输入角色描述"},null,8,["modelValue"])]),_:1}),u(r,{gutter:20},{default:i(()=>[u(t,{span:12},{default:i(()=>[u(o,{label:"排序",prop:"sort"},{default:i(()=>[u(f,{modelValue:m(M).sort,"onUpdate:modelValue":l[3]||(l[3]=e=>m(M).sort=e),min:0,max:999,placeholder:"请输入排序",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),u(t,{span:12},{default:i(()=>[u(o,{label:"状态",prop:"status"},{default:i(()=>[u(N,{modelValue:m(M).status,"onUpdate:modelValue":l[4]||(l[4]=e=>m(M).status=e),placeholder:"请选择状态",style:{width:"100%"}},{default:i(()=>[u(g,{label:"启用",value:1}),u(g,{label:"禁用",value:0})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}});export{U as _};
