var e=(e,l,a)=>new Promise((t,i)=>{var d=e=>{try{s(a.next(e))}catch(l){i(l)}},o=e=>{try{s(a.throw(e))}catch(l){i(l)}},s=e=>e.done?t(e.value):Promise.resolve(e.value).then(d,o);s((a=a.apply(e,l)).next())});import{d as l,c as a,a as t,r as i,w as d,y as o,f as s,z as r,p as u,e as c,G as n,H as p,h as m,l as _,N as f,n as v}from"./index-tq4TX8ps.js";import{E as b}from"./el-dialog-BuI0cT_W.js";import"./el-overlay-eO4DGCYD.js";import{E as g}from"./el-button-DyAC8C5p.js";import{E as y,a as h}from"./el-form-item-DcUonGVO.js";import{a as j,b as V}from"./el-radio-DLchf3N0.js";/* empty css                       */import{E as w}from"./el-row-B5j5eqHP.js";/* empty css                 */import{E as x}from"./el-col-BO93OLd3.js";/* empty css               */import{E as D,a as E}from"./el-option-DXreI6jV.js";/* empty css                  *//* empty css                     *//* empty css                  */import{c as k,u as U,g as q}from"./dict-aLvmxoEp.js";import{E as H}from"./index-DiYLWqjA.js";const I={class:"dialog-footer"},P=l({__name:"DictItemDialog",props:{visible:{type:Boolean},type:{},dictData:{}},emits:["update:visible","submit"],setup(l,{emit:P}){const C=l,M=P,N=a({get:()=>C.visible,set:e=>M("update:visible",e)}),O=a(()=>C.type),R=t(),z=t(!1),B=i({dict_type_id:void 0,dict_label:"",dict_value:"",is_default:0,status:1,description:""}),G=t([]),L=t(!1),Q={dict_type_id:[{required:!0,message:"请选择字典类型",trigger:"blur"}],dict_label:[{required:!0,message:"请输入字典标签",trigger:"blur"},{min:1,max:50,message:"长度在 1 到 50 个字符",trigger:"blur"}],dict_value:[{required:!0,message:"请输入字典键值",trigger:"blur"},{min:1,max:50,message:"长度在 1 到 50 个字符",trigger:"blur"}],status:[{required:!0,message:"请选择状态",trigger:"blur"}]},T=()=>e(null,null,function*(){const e="edit"===C.type&&C.dictData,l=C.dictData;Object.assign(B,{dict_type_id:(null==l?void 0:l.dict_type_id)||void 0,dict_label:e&&l&&l.dict_label||"",dict_value:e&&l&&l.dict_value||"",is_default:e&&l?l.is_default:0,status:e&&l?l.status:1,description:e&&l&&l.description||""})});d(()=>C.visible,l=>{l&&e(null,null,function*(){L.value=!0;try{const e=yield q();e&&(G.value=e)}catch(e){}finally{L.value=!1}}).then(()=>{T(),v(()=>{var e;null==(e=R.value)||e.clearValidate()})})},{immediate:!0}),d(()=>[C.type,C.dictData],()=>{C.visible&&T()});const A=()=>e(null,null,function*(){R.value&&(yield R.value.validate(l=>e(null,null,function*(){var e;if(l){z.value=!0;try{if("add"===O.value)yield k(B),f.success("添加成功");else{if(!(null==(e=C.dictData)?void 0:e.id))throw new Error("字典项ID不存在");yield U(C.dictData.id,B),f.success("更新成功")}N.value=!1,M("submit")}catch(a){f.error(a.message||"操作失败")}finally{z.value=!1}}})))});return(e,l)=>{const a=E,t=D,i=h,d=x,f=H,v=w,k=V,U=j,q=y,P=g,C=b;return s(),o(C,{modelValue:N.value,"onUpdate:modelValue":l[6]||(l[6]=e=>N.value=e),title:"add"===O.value?"添加字典值":"编辑字典值",width:"600px","align-center":"","close-on-click-modal":!1},{footer:r(()=>[m("div",I,[u(P,{onClick:l[5]||(l[5]=e=>N.value=!1)},{default:r(()=>[...l[7]||(l[7]=[_("取消",-1)])]),_:1}),u(P,{type:"primary",onClick:A,loading:z.value},{default:r(()=>[...l[8]||(l[8]=[_("提交",-1)])]),_:1},8,["loading"])])]),default:r(()=>[u(q,{ref_key:"formRef",ref:R,model:B,rules:Q,"label-width":"100px"},{default:r(()=>[u(v,{gutter:20},{default:r(()=>[u(d,{span:12},{default:r(()=>[u(i,{label:"字典类型",prop:"dict_type_id"},{default:r(()=>[u(t,{modelValue:B.dict_type_id,"onUpdate:modelValue":l[0]||(l[0]=e=>B.dict_type_id=e),placeholder:"请选择字典类型",disabled:"edit"===O.value||L.value,filterable:"",clearable:"",loading:L.value},{default:r(()=>[(s(!0),c(n,null,p(G.value,e=>(s(),o(a,{key:e.dict_code,label:e.dict_name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled","loading"])]),_:1})]),_:1}),u(d,{span:12},{default:r(()=>[u(i,{label:"字典标签",prop:"dict_label"},{default:r(()=>[u(f,{modelValue:B.dict_label,"onUpdate:modelValue":l[1]||(l[1]=e=>B.dict_label=e),placeholder:"请输入字典标签",clearable:"",maxlength:50,"show-word-limit":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),u(v,{gutter:20},{default:r(()=>[u(d,{span:12},{default:r(()=>[u(i,{label:"字典键值",prop:"dict_value"},{default:r(()=>[u(f,{modelValue:B.dict_value,"onUpdate:modelValue":l[2]||(l[2]=e=>B.dict_value=e),placeholder:"请输入字典键值",clearable:"",maxlength:50,"show-word-limit":""},null,8,["modelValue"])]),_:1})]),_:1}),u(d,{span:12},{default:r(()=>[u(i,{label:"是否默认",prop:"is_default"},{default:r(()=>[u(U,{modelValue:B.is_default,"onUpdate:modelValue":l[3]||(l[3]=e=>B.is_default=e),placeholder:"请选择是否默认"},{default:r(()=>[u(k,{label:"是",value:1}),u(k,{label:"否",value:0})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),u(v,{gutter:20},{default:r(()=>[u(d,{span:24},{default:r(()=>[u(i,{label:"描述",prop:"description"},{default:r(()=>[u(f,{type:"textarea",rows:3,modelValue:B.description,"onUpdate:modelValue":l[4]||(l[4]=e=>B.description=e),placeholder:"请输入描述",clearable:"",maxlength:200,"show-word-limit":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}});export{P as _};
